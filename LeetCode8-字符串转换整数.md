# LeetCode8-字符串转换整数

## 题目描述

请你来实现一个 myAtoi(string s) 函数，使其能将字符串转换成一个 32 位有符号整数（类似 C/C++ 中的 atoi 函数）。

函数 myAtoi(string s) 的算法如下：

（1）读入字符串并丢弃无用的前导空格
（2）检查下一个字符（假设还未到字符末尾）为正还是负号，读取该字符（如果有）。 确定最终结果是负数还是正数。 如果两者都不存在，则假定结果为正。
（3）读入下一个字符，直到到达下一个非数字字符或到达输入的结尾。字符串的其余部分将被忽略。
（4）将前面步骤读入的这些数字转换为整数（即，"123" -> 123， "0032" -> 32）。如果没有读入数字，则整数为 0 。必要时更改符号（从步骤 2 开始）。
（5）如果整数数超过 32 位有符号整数范围 [−2^31,  2^31 − 1] ，需要截断这个整数，使其保持在这个范围内。具体来说，小于 −2^31 的整数应该被固定为 −2^31 ，大于 2^31 − 1 的整数应该被固定为 2^31 − 1 。
返回整数作为最终结果。
注意：

本题中的空白字符只包括空格字符 ' ' 。
除前导空格或数字后的其余字符串外，请勿忽略 任何其他字符。


示例 1：

输入：s = "42"
输出：42
解释：加粗的字符串为已经读入的字符，插入符号是当前读取的字符。
第 1 步："42"（当前没有读入字符，因为没有前导空格）
         ^
第 2 步："42"（当前没有读入字符，因为这里不存在 '-' 或者 '+'）
         ^
第 3 步："42"（读入 "42"）
           ^
解析得到整数 42 。
由于 "42" 在范围 [-231, 231 - 1] 内，最终结果为 42 。
示例 2：

输入：s = "   -42"
输出：-42
解释：
第 1 步："   -42"（读入前导空格，但忽视掉）
            ^
第 2 步："   -42"（读入 '-' 字符，所以结果应该是负数）
             ^
第 3 步："   -42"（读入 "42"）
               ^
解析得到整数 -42 。
由于 "-42" 在范围 [-231, 231 - 1] 内，最终结果为 -42 。
示例 3：

输入：s = "4193 with words"
输出：4193
解释：
第 1 步："4193 with words"（当前没有读入字符，因为没有前导空格）
         ^
第 2 步："4193 with words"（当前没有读入字符，因为这里不存在 '-' 或者 '+'）
         ^
第 3 步："4193 with words"（读入 "4193"；由于下一个字符不是一个数字，所以读入停止）
             ^
解析得到整数 4193 。
由于 "4193" 在范围 [-231, 231 - 1] 内，最终结果为 4193 。
示例 4：

输入：s = "words and 987"
输出：0
解释：
第 1 步："words and 987"（当前没有读入字符，因为没有前导空格）
         ^
第 2 步："words and 987"（当前没有读入字符，因为这里不存在 '-' 或者 '+'）
         ^
第 3 步："words and 987"（由于当前字符 'w' 不是一个数字，所以读入停止）
         ^
解析得到整数 0 ，因为没有读入任何数字。
由于 0 在范围 [-231, 231 - 1] 内，最终结果为 0 。
示例 5：

输入：s = "-91283472332"
输出：-2147483648
解释：
第 1 步："-91283472332"（当前没有读入字符，因为没有前导空格）
         ^
第 2 步："-91283472332"（读入 '-' 字符，所以结果应该是负数）
          ^
第 3 步："-91283472332"（读入 "91283472332"）
                     ^
解析得到整数 -91283472332 。
由于 -91283472332 小于范围 [-231, 231 - 1] 的下界，最终结果被截断为 -231 = -2147483648 。


提示：

0 <= s.length <= 200
s 由英文字母（大写和小写）、数字（0-9）、' '、'+'、'-' 和 '.' 组成

## 题解

### 方法一：根据题目描述，逐个条件判断

（1）方法描述

①基本思想：根据题目描述，依据判断条件依次对字符串中的每个字符进行判断。

②符合条件的字符串：寻找以有符号整型数开始的字符串中的数字部分构成的整数（数字前面的空格可以忽略）

ⅰ数字部分：数字必须是连续的，中间不能有空格

ⅱ字符串的开头：可以是数字、正负号、空格

③判断顺序：先开头，后数字

ⅰ前面的空格全部跳过

ⅱ有效字符的第一个字符是否为正负号（将前导空格视为无效字符），如果是的话，则将相应的符号标记置为相应的值；如果第一个有效字符为数字，则默认转化后的结果为正数

ⅲ有效字符是否为数字：根据字符之间的ASCII码比较进行判断，ASCII码值在数字0的ASCII码（30H）数字9的ASCII码(39H)之间的字符即为数字

也可以利用C++中提供的函数进行判断：

函数 bool isdigit(char c)，如果字符c是数字，则函数的返回值为true，反之，函数的返回值为false

数值的计算：用当前字符减去字符0得到对应数字

ⅳ 溢出判断：由于将字符串中的数字全部转换完成后可能存在溢出的情况，所以在边转换的过程中就要边判断

INT_MAX=2^32-1=2147483647
INT_MIN=-2^32=-2147483648

由于逐个识别数字的过程中从高位向低位进行，当前判断得出的数字在下一次的判断中要作为高位权值的数值（通过乘以10实现），所以每次溢出的判断是针对本轮的判断先进行，所以上一次得到的数值结果要与边界值除以10的结果进行比较。

总结：溢出判断在每次将该位上的数字作为整数的一部分之前进行，溢出的边界条件时原32位整数边界除以10的结果。

④数字字符转换为整数的方法:

ⅰ单个字符转换为数字：通过字符间的减法操作（ASCII码相减）得到对应的数字 

ⅱ各个数字转换为整数：按照每个数字所在位的位权，将得到的数字依次通过前一次的结果乘以10加上当前的数字得到对应的整数。

⑤返回值：通过标记整数的符号和得到的非负整数的乘积得到真正的整数

（2）具体实现

```
class Solution {
public:
    int myAtoi(string s)
    {
        int index=0;//记录所处理的字符在字符串中的下标
        int sign=1;//记录整数的符号，默认为正号
        int number=0;//记录字符串中连续的数字子串转换为整数的结果
        while(s[index]==' ')//排除空白字符（空格）的影响
        {
            ++index;//当字符串的前面是空格时，通过向右移动指示的下标，跳过空格
        }
        if(s[index]=='+' || s[index]=='-')//遇到正负号时，需要记录符号，符号判断完成后，更新字符下标
        {
            if(s[index++]=='-')//如果是负号，sign值为-1
            {
                sign=-1;
            }
            else//如果是正号，sign值是1
            {
                sign=1;
            }
        }
        while(s[index] >= '0' && s[index] <= '9')//如果字符中存在数字（ASCII码值介于0~9之间）
        {
            if(number>INT_MAX/10 || (number==INT_MAX/10 && s[index]-'0' > 7))//溢出判断
            {
                if(sign==1)//正溢，返回的结果是32位整数的最大值
                {
                    return INT_MAX;
                }
                else//负溢，返回的结果是32位整数的最小值
                {
                    return INT_MIN;
                }
            }
            number=number*10+(s[index++]-'0');//将上一次得到的整数结果作为高位上的值，再加上当前得到的数字构成本轮循环结束得到的整数结果，计算完成后更新下标
        }
        return number*sign;//返回符号与数值部分的乘积得到的整数值
    }
};
```

（3）运行结果

![image-20220116164755521](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20220116164755521.png)

### 方法二：用流操作完成对字符串中连续数字子串的筛选

（1）方法介绍：

①基本思想：利用C++中的istringstream类，对内存中的字符串进行字符串到数字的转换

②字符串转换为数字：用字符串初始化流操作对象，然后通过该对象调用流操作符，同时指定操作的类型，可将字符串转化为指定类型的整数。

C++ 有两个类，ostringstream 和 istringstream，可以用来对内存中的值执行字符串/数字转换。

ostringstream 类是 ostream 的子类（cout 也属于该类），并使用流插入运算符 << 将数值转换为字符串。ostringstream 类型对象的工作方式与cout和文件对象的工作方式相同，但它不是将数据写入屏幕或文件，而是写入它所包含的字符串对象中。

每次在 ostringstream 对象上使用 << 时，它都会执行必要的数字到字符串的转换，并将结果追加到其字符串的末尾。除了支持 ostream 类的所有成员函数和运算符外，ostringstream 对象还支持如下表中所示的 str 成员函数。

istringstream 类是从 istream 派生的。它内部包含一个字符串对象，函数将它作为可以从中"读取"的输入流。

输入流可以在创建对象时由 istringstream 构造函数设置，也可以在创建对象后通过调用 str(string s) 函数来设置。流提取操作符 >> 从封闭的字符串中读取，并在必要时将字符串转换为数字。表 1 列出了 istringstream 的成员函数，必须在程序中包含 `sstream` 头文件才能使用这些类。

![image-20220122224524125](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20220122224524125.png)

③溢出判断：对转化后的整数判断，看是否超出32位整数的范围

（2）具体实现：

```
//利用流操作格式化分解字符串，分解的依据是输出对象的类型
class Solution {
public:
    int myAtoi(string str)
   {
      int num=0;//定义存储转化结果的变量并初始化为0
      istringstream str_I(s);//定义流操作对象str_I,并用字符串s初始化
      str_I >> num;//通过流操作符>>完成字符串到数字的转化
      if (num > INT_MAX)//判断是否上溢
          return INT_MAX;
      else if (num < INT_MIN)//判断是否下溢
          return INT_MIN;
      else//未溢出时，返回转化后的整数值
          return num;
}
};
```

（3）运行结果

![image-20220122225650488](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20220122225650488.png)

